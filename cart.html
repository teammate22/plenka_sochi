<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="rapota/stylera.css">
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon">
    <title>Стретч-пленка в Сочи</title>
</head>
<body>
    <header id="cart">
        <nav>
            <ul>
                <li><a href="index.html">Главная</a></li>
                <li><a href="catalog.html">Каталог</a></li>
                <li><a href="about.html">Контакты</a></li>
                <li><a href="cart.html">Корзина</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <h1>Корзина</h1>
        <div id="cart-items"></div>
        <button id="checkout-button">Оформить</button>
        <form id="checkout-form" style="display:none;">
            <h2>Заполните ваши данные</h2>
            <label for="name">ФИО:</label>
            <input type="text" id="name" name="name" required>
            <label for="phone">Номер телефона:</label>
            <input type="text" id="phone" name="phone" required>
            <label for="address">Адрес:</label>
            <input type="text" id="address" name="address" required>
            <button type="submit">Отправить</button>
        </form>
    </main>
    <script>
// Функция для загрузки товаров из корзины и отображения общей стоимости заказа
function loadCartItems() {
    const cartItemsContainer = document.getElementById('cart-items');
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const totalPrice = calculateTotalPrice(cart);

    if (cart.length === 0) {
        cartItemsContainer.innerHTML = '<p>Корзина пуста</p>';
    } else {
        let itemsHTML = '<ul>' + cart.map((item, index) => `
            <li>
                <h3>${item.name}</h3>
                <p>Цена: ${item.price} рублей</p>
                <p>Размер: ${item.size}</p>
                <button onclick="removeFromCart(${index})">Удалить</button>
            </li>
        `).join('') + '</ul>';
        itemsHTML += `<p class='total_cost'>Общая стоимость заказа: ${totalPrice} рублей</p>`;
        cartItemsContainer.innerHTML = itemsHTML;
    }
}


// Функция для удаления товара из корзины
function removeFromCart(index) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.splice(index, 1);
    localStorage.setItem('cart', JSON.stringify(cart));
    loadCartItems();
}

// Функция для вычисления общей стоимости товаров в корзине
function calculateTotalPrice(cart) {
    let totalPrice = 0;
    for (const item of cart) {
        totalPrice += parseFloat(item.price);
    }
    return totalPrice.toFixed(2); // Округляем до двух знаков после запятой
}


// Функция для обработки клика по кнопке "Оформить"
function handleCheckoutClick() {
    document.getElementById('checkout-form').style.display = 'block';
}

// Функция для обработки отправки формы
function handleFormSubmit(event) {
    event.preventDefault();
    alert('Ваш заказ был успешно отправлен!');
    localStorage.removeItem('cart');
    loadCartItems();
    document.getElementById('checkout-form').reset();
    document.getElementById('checkout-form').style.display = 'none';
}

document.getElementById('checkout-button').addEventListener('click', handleCheckoutClick);
document.getElementById('checkout-form').addEventListener('submit', handleFormSubmit);

// Загрузка товаров при загрузке страницы
loadCartItems();
</script>
</body>
</html>
